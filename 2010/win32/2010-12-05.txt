オススメしないperlの実行方法
meta-author: techno-cat
meta-tags: perl, win32

お仕事では、100% Windowsなtechno-cat(@techno_neko)デス。
今回は、オススメしないperlの実行方法を紹介します。


みなさんは、wsfをご存知でしょうか？
>http://msdn.microsoft.com/ja-jp/library/cc392507.aspx>
Windows スクリプト (*.wsf) ファイルは、XML (Extensible Markup Language) コードを含むテキスト ドキュメントです。Windows スクリプト ファイルでは、スクリプトの柔軟性を向上するいくつかの機能がサポートされています。Windows スクリプト ファイルはエンジンに依存しないので、Windows スクリプト互換の任意のスクリプト エンジンで作成したスクリプトを Windows スクリプト ファイルに含めることができます。Windows スクリプト ファイルは、一種のコンテナとして機能します。
<<

だそうなので、さっそくperlをスクリプト エンジンとしたwsfを書いちゃいましょう。


まずは、いつもの。
>||
<job>
<script language="PerlScript">

$WScript->Echo("hello world.");

</script>
</job>
||<

これを応用して、ファイルをドラッグ＆ドロップして、
処理する場合はこんな感じ。
>||
<job>
<script language="PerlScript">

my $args = $WScript->Arguments;
if ( 0 < $args->Count ) {
	$WScript->Echo( $args->Item(0) );
}
</script>
</job>
||<


もちろん、渡されたパスからファイルを読み込んで、
何か処理をして、その結果を出力することも出来ますが、
次はオススメしない理由です。


結論から言うと、日本語のコメントを入れると、意味不明なエラーが出ます。
>||
<job>
<script language="PerlScript">

my $args = $WScript->Arguments;
if ( 0 < $args->Count ) {
	# ドラッグ＆ドロップで受け取った最初のパスを
	# メッセージボックスで表示！
	$WScript->Echo( $args->Item(0) );
}
</script>
</job>
||<


こんな感じで、ファイルの先頭で文字コード指定したり、
>||
<?XML version="1.0" standalone="yes" encoding="euc-jp" ?>
||<
可能な限りいろいろ試してもダメでした。
なので、今はJScriptから呼び出すようにしています。


という訳で、オススメしないよ！っていうMSWin32Tipsでした！！
次は、 @songmu さんデス！
