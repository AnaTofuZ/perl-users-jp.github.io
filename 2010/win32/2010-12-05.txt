お仕事では、100% Windowsなtechno_nekoデス。

今回は、オススメしないperlの実行方法を紹介します。

みなさんは、wsfをご存知でしょうか？
>>
Windows スクリプト (*.wsf) ファイルは、XML (Extensible Markup Language) コードを含むテキスト ドキュメントです。
Windows スクリプト ファイルでは、スクリプトの柔軟性を向上するいくつかの機能がサポートされています。
Windows スクリプト ファイルはエンジンに依存しないので、
Windows スクリプト互換の任意のスクリプト エンジンで作成したスクリプトを Windows スクリプト ファイルに含めることができます。
Windows スクリプト ファイルは、一種のコンテナとして機能します。

http://msdn.microsoft.com/ja-jp/library/cc392507.aspx より引用
<<

だそうなので、さっそくperlをスクリプト エンジンとしたwsfを書いちゃいましょう。

まずは、いつもの。
>||
<job>
<script language="PerlScript">

$WScript->Echo("hello world.");

</script>
</job>
||<

これを応用して、ファイルをドラッグ＆ドロップして、
処理する場合はこんな感じ。
>||
<job>
<script language="PerlScript">

my $args = $WScript->Arguments;
if ( 0 < $args->Count ) {
	$WScript->Echo( $args->Item(0) );
}
</script>
</job>
||<

もちろん、渡されたパスからのファイルを読み込んで、
何か処理をして、その結果を出力することも出来ますが、
次はオススメしない理由です。

結論から言うと、日本語のコメントを入れると、
意味不明なエラーが出ます。
>||
<job>
<script language="PerlScript">

my $args = $WScript->Arguments;
if ( 0 < $args->Count ) {
	# ドラッグ＆ドロップで受け取った最初のパスをメッセージボックスで表示！
	$WScript->Echo( $args->Item(0) );
}
</script>
</job>
||<

>||
<?XML version="1.0" standalone="yes" encoding="euc-jp" ?>
||<
こんな感じで、ファイルの先頭で文字コード指定したり、
可能な限りいろいろ試してもダメでした。
なので、今はJScriptから呼び出すようにしています。

という訳で、オススメしないよ！っていうMSWin32Tipsでした！！
次は、どなたでしょうか？？
